<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Document</title>
	</head>
	<body>
		<p>
			<span>question-1</span>
			<span id="question-1">-</span>
		</p>
		<button class="vote-btn" id="q1-vote-btn" value="1">click</button>
		<p>
			<span>question-2</span>
			<span id="question-2">-</span>
		</p>
		<button class="vote-btn" id="q2-vote-btn" value="2">click</button>
		<p>
			<span>question-3</span>
			<span id="question-3">-</span>
		</p>
		<button class="vote-btn" id="q3-vote-btn" value="3">click</button>
	</body>

	<script>
    const HOST = 'http://10.17.249.238:8088';

    // fetch data from api
    fetch(`${HOST}/api/furkid/read.php`)
      .then(response => response.json())
      .then(data => {
          console.log(data);
          for(let i = 0; i < 3; i++) {
            document.getElementById(`question-${i+1}`).innerHTML = data.body[i].participants;
          }
      });

		const btns = document.querySelectorAll('.vote-btn');

    [...btns].forEach(btn => {
      btn.addEventListener('click', function(e) {
        const btn = e.target;
        const value = btn.getAttribute('value');

        // fetch post
        fetch(`${HOST}/api/furkid/update.php?id=${value}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
        })
          .then(res => {
            if (res.status === 200) {
              const currentValue = document.getElementById(`question-${value}`).innerHTML
              document.getElementById(`question-${value}`).innerHTML = +currentValue + 1;
            }
          });
      });
    });
	</script>
</html>
